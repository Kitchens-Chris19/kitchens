<!DOCTYPE html>
<html>

<head>
   <link rel="stylesheet" type="text/css" href="hpStyle.css">
   <link href="https://fonts.googleapis.com/css?family=Galdeano" rel="stylesheet">
   <div class="navbar">
      <a href="index.html">Home</a>
      <a href="ajax.html">AJAX</a>
      <a href="dom.html">DOM</a>
      <a href="htmltags.html">HTML Tags</a>
      <a href="localStorage.html">Local Storage</a>
      <div class="dropdown">
         <button class="dropbtn">CSS3
            <i class="fa fa-caret-down"></i>
         </button>
         <div class="dropdown-content">
            <a href="css3animate.html">CSS3 Animations</a>
            <a href="css3transform.html">CSS3 Transforms</a>
            <a href="css3transition.html">CSS3 Transitions</a>
            <a href="cssjs.html">CSS3 with JS</a>
            <a href="css3all.html">CSS3 All Combined</a>
         </div>
      </div>
      <div class="dropdown">
         <button class="dropbtn">JavaScript
            <i class="fa fa-caret-down"></i>
         </button>
         <div class="dropdown-content">
            <a href="jsArrays.html">Arrays</a>
            <a href="jsobj.html">Objects</a>
            <a href="json.html">JSON</a>
            <a href="jsevents.html">JS Events</a>
         </div>
      </div>
   </div>
</head>

<body onload="start();">
   <div id="sky"></div>
   <div id="leftDiv">
      <div id="playerInfo" class="glowBorder">
            <h2>Player Info</h2>
            <p id="name">Name</p>
            <p id="house">House</p>
            <p id="points">0</p>
            <button type="button" id="getData" onclick=getData()>New Player</button> <br>
            <button type="button" id="saveStorage" onclick=savePlayer()>Save Player</button> <br>
            <button type="button" id="loadStorage" onclick=loadPlayer()>Load Player</button> <br>
            <button type="button" id="clear" onclick = localStorage.clear()>Clear Player</button>
            <button id="loadBtn" type="button" onclick="loadQuiz(counter);">Load Quiz</button>
         </div>
   </div>

   <image id="hpBroom" src="images/hp_right1.png" alt="broom"></image>

   <button id="modalBtn" type="button" style="position: absolute; transform: translateY(500px);">Instructor?</button>

   <div id="modalDescr" class="modal">
      <div class="modalContent">
         <span class="close">&times;</span>
         
         <h1 style="color: black;">A description of how the various topics were used in the making of this page:</h1><br>
         <table>
            <tr>
               <td>
                     <p>CSS3 Animations:</p>
                     <ul>
                        <li>Title of the quiz, win text, and Deathly Hallows text using an animation to continuously glow.</li>
                        <li>The quiz (parchment section) uses an animation to continuously hover.</li>
                        <li>The Player Info div glows whenever points are added and in response to player changes via animation/resetting animation.</li>
                        <li>When you win the game, Harry goes flying.</li>
                        <li>200 Twinkling stars in the sky - twinkling via continuous/random animation.</li>
                     </ul>
                     <p>CSS3 Transitions:</p>
                     <ul>
                        <li>Button matrix transform is set on a transition timer of 1s.</li>
                        <li>Deathly Hallows text opacity transition set to 1s.</li>
                        <li>Deathly Hallows stone movement left transition set to 1s.</li>
                        <li>Deathly Hallows wand movement left transition set to 1s.</li>
                     </ul>
                     <p>CSS3 Transforms:</p>
                     <ul>
                        <li>Use of transform: translate within hover animations.</li>
                        <li>Use of transform: matrix within Harry flying animation.</li>
                        <li>Use of transform: matrix on buttons when you hover over them.</li>
                        <li>Use of transform: translate on the playerInfo div for positioning.</li>
                        <li>Use of transform: translate on the questionContainer for positioning.</li>
                        <li>Use of transform: translate on the parchment image for positioning.</li>
                        <li>Use of transform: translate on the innertext of the parchment image for positioning.</li>
                        <li>Use of transform: none on the navbar to override other button settings.</li>
                        <li>Use of transform: matrix on Harry image.</li>
                        <li>Use of transform: translate on Deathly Hallows container and text for positioning.</li>
                     </ul>
               </td>
               <td>
                     <p>JavaScript</p>
                     <ul>
                        <li>The Player is saved as an object.</li>
                        <li>JSON is used to save/load the player object.</li>
                        <li>Body uses onload to retrieve the quiz information via AJAX.</li>
                        <li>Buttons have onclick function calls to save/load/clear player information, load the quiz on the screen, present this modal, and submit answers to questions.</li>
                        <li>The Deathly Hallows react with onmouseover and onmouseout to either show or hide text.</li>
                        <li>Loops for loading questions on screen and into table. Loops for creating star divs.</li>
                        <li>Many different functions for controlling most things mentioned in this modal.</li>
                     </ul>
                     <p>AJAX</p>
                     <ul>
                        <li>AJAX is used to retrieve the quiz questions and answers from an xml file and load them into a table for later use.</li>
                     </ul>
                     <p>DOM</p>
                     <ul>
                        <li>The questions/answers are updated by changing their inner text.</li>
                        <li>Player Info is referenced by its ID for use in multiple functions.</li>
                        <li>Text elements/buttons are hidden/shown based on events and conditions.</li>
                        <li>Creating 200 stars to put in the sky.</li>
                     </ul>
                     <p>Tags</p>
                     <ul>
                        <li>Images used for background, Harry, and parchment.</li>
                     </ul>
                     <p>Local Storage</p>
                     <ul>
                        <li>Player information, including name, House, and score are saved in Local Storage and accessed with buttons.</li>
                     </ul>
               </td>
            </tr>
         </table>
      </div>
   </div>

   <div id="dhContainer">
      <div class="deathlyHallows">
         <div class="cloak" onmouseover="showDHText(true);" onmouseout="showDHText(false);">
            <div class="stone"></div>
            <div class="wand"></div>
         </div>
      </div>
      <p id="dhText" class="glow">The Deathly Hallows</p>
      <p class="glow" style="font-style: italic; transform: translate(167px, -164px);">Mouse over</p>
   </div>

   <div class="hero-image">
      <div class="hero-text">
         <h1 class="glow">
            Harry Potter Trivia!
         </h1>
         <div id="hpDiv">
            <div id="questionDiv" style="display: none;">
               <h3 id="question">Question</h3><br><br>
               
               <div id="questionContainer">
                     <input type="radio" name="answer" id="a" value="a">
                     <h4 id="ha" style="display: inline;">Answer A</h4> <br><br>
                     <input type="radio" name="answer" id="b" value="b">
                     <h4 id="hb" style="display: inline;">Answer B</h4> <br><br>
                     <input type="radio" name="answer" id="c" value="c">
                     <h4 id="hc" style="display: inline;">Answer C</h4> <br><br>
                     <input type="radio" name="answer" id="d" value="d">
                     <h4 id="hd" style="display: inline;">Answer D</h4> <br><br>
               </div>
               
               <button id="submitBtn" type="button" onclick="submitAnswer(counter);">Submit Answer</button>
            </div>
         </div>
      </div>
   </div>
   

   <table id="table" style="display: none;"></table>

   

   <script>
      function start() {
         loadXML();
         stars();
      }

      var counter = 1;
      var playerNum = 0;
      var name, house, player;

      function savePlayer() {
         localStorage.setItem("player", JSON.stringify(player));
         infoChange();
      }

      function loadPlayer() {
         player = JSON.parse(localStorage.getItem("player"));
         if (player!=null) {
            document.getElementById("name").innerHTML = player.name;
            document.getElementById("house").innerHTML = player.house;
            document.getElementById("points").innerHTML = player.points;
            infoChange();
         } else {
            alert("No players in storage.");
         }
      }

      function Player(name, house) {
         this.name = name;
         this.house = house;
         this.points = 0;
      }

      function getData() {
         name = prompt("Enter your name.", "Name");
         house = prompt("Enter your Hogwarts House.", "House");

         player = new Player(name, house);
         document.getElementById('name').innerHTML = player.name;
         document.getElementById('house').innerHTML = player.house;
         var x = document.getElementById('getData');
         x.setAttribute('disabled', '');
         infoChange();
      }

      function youWin() {
         var x = document.getElementById("questionDiv");
         x.style.display = "none";

         var d = document.createElement("div");
         d.className = "winDiv";
         d.innerHTML = "YOU WIN!!!";

         document.getElementById("hpDiv").appendChild(d);

         var flyer = document.getElementById('hpBroom');
         flyer.style.animation = "fly 7s";

      }

      function submitAnswer(questionNum) {
         var data = document.getElementById("table").rows[questionNum].cells;
         var correctAnswer = data[5].innerHTML;
         var userAnswer = document.querySelector('input[name="answer"]:checked').value;
         console.log("correctAnswer: " + correctAnswer);
         console.log("userAnswer: " + userAnswer);

         if (correctAnswer == userAnswer) {
            if(player!=null) {
               player.points += 10;
               document.getElementById('points').innerHTML = player.points;
               infoChange();
            }
            counter++;
            if (counter < 5) {
               loadQuiz(counter);
            } else if (counter == 5) {
               youWin();
               return;
            }
         } else {
            alert("WRONG");
         }

         var radios = document.getElementsByName("answer");
         for (let index = 0; index < 4; index++) {
            radios[index].checked = false;
         }

      }

      function loadQuiz(questionNum) {
         var btn = document.getElementById("loadBtn");
         btn.style.display = "none";

         var x = document.getElementById('questionDiv');
         x.style.display = '';

         var data = document.getElementById("table").rows[questionNum].cells;
         document.getElementById("question").innerHTML = data[0].innerHTML;
         document.getElementById("ha").innerHTML = data[1].innerHTML;
         document.getElementById("hb").innerHTML = data[2].innerHTML;
         document.getElementById("hc").innerHTML = data[3].innerHTML;
         document.getElementById("hd").innerHTML = data[4].innerHTML;
      }

      function infoChange() {
         var glowy = document.getElementById('playerInfo');
         glowy.style.animation = "none";
         glowy.offsetHeight;
         glowy.style.animation = null;
      }

      function showDHText(show) {
         var x = document.getElementById('dhText');
         if(show) {
            x.style.opacity = "1";
         }
         if(!show) {
            x.style.opacity = "0";
         }
      }

      function stars() {
         var sky = document.getElementById('sky');
         var topNum;
         var leftNum;
         var animateTime;

         for (var i = 0; i < 200; i++) {
            topNum = (Math.random() * 500).toFixed(0).toString();
            leftNum = (Math.random() * 2000).toFixed(0).toString();
            animateTime = ((Math.random() * 5) + 5).toFixed(0).toString()
            var star = document.createElement('div');
            star.className = "star";
            star.style.animation = 'twinkle ' + animateTime + 's linear ' + animateTime + 's infinite';
            star.style.top = topNum + 'px'; 
            star.style.left = leftNum + 'px';


            // var star = '<div class="star" style="animation: twinkle ' 
            // + ((Math.random() * 5) + 5) + 's linear ' + ((Math.random() * 5) + 5) 
            // + 's infinite; top: ' + Math.random() * 500 + 'px; left: ' 
            // + Math.random() * 1000 + 'px;"></div>';
            sky.appendChild(star);
         }
      }

      function loadXML() {

         var xhttp = new XMLHttpRequest();
         xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
               xmlToTable(this);
            }
         };
         xhttp.open("GET", "quiz.xml", true);
         xhttp.send();
      }

      function xmlToTable(xml) {
         var i;
         var xmlDoc = xml.responseXML;
         var table = "<tr><th>Question</th><th>AnswerA</th><th>AnswerB</th><th>AnswerC</th><th>AnswerD</th><th>CorrectAnswer</th></tr>";
         var x = xmlDoc.getElementsByTagName("QUESTION");
         for (i = 0; i < x.length; i++) {
            table += "<tr><td>";
            table += x[i].getElementsByTagName("TEXT")[0].childNodes[0].nodeValue;
            table += "</td><td>";
            table += x[i].getElementsByTagName("ANSWERA")[0].childNodes[0].nodeValue;
            table += "</td><td>";
            table += x[i].getElementsByTagName("ANSWERB")[0].childNodes[0].nodeValue;
            table += "</td><td>";
            table += x[i].getElementsByTagName("ANSWERC")[0].childNodes[0].nodeValue;
            table += "</td><td>";
            table += x[i].getElementsByTagName("ANSWERD")[0].childNodes[0].nodeValue;
            table += "</td><td>";
            table += x[i].getElementsByTagName("CORRECTANSWER")[0].childNodes[0].nodeValue;
            table += "</td></tr>";
         }
         document.getElementById("table").innerHTML = table;
      }

   </script>

   <script>
      // Get the modal
      var modal = document.getElementById('modalDescr');
      
      // Get the button that opens the modal
      var btn = document.getElementById("modalBtn");
      
      // Get the <span> element that closes the modal
      var span = document.getElementsByClassName("close")[0];
      
      // When the user clicks the button, open the modal 
      btn.onclick = function() {
        modal.style.display = "block";
      }
      
      // When the user clicks on <span> (x), close the modal
      span.onclick = function() {
        modal.style.display = "none";
      }
      
      // When the user clicks anywhere outside of the modal, close it
      window.onclick = function(event) {
        if (event.target == modal) {
          modal.style.display = "none";
        }
      }
   </script>
</body>

</html>